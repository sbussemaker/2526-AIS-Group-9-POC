services:
  kadaster-service:
    build: ./mcp-servers/kadaster-service
    container_name: eai-kadaster-service
    stdin_open: true
    tty: false
    restart: unless-stopped

  cbs-service:
    build: ./mcp-servers/cbs-service
    container_name: eai-cbs-service
    stdin_open: true
    tty: false
    restart: unless-stopped

  rijkswaterstaat-service:
    build: ./mcp-servers/rijkswaterstaat-service
    container_name: eai-rijkswaterstaat-service
    stdin_open: true
    tty: false
    restart: unless-stopped

  agent-service:
    build: ./mcp-servers/agent-service
    container_name: eai-agent-service
    stdin_open: true
    tty: false
    restart: unless-stopped
    env_file:
      - .env
    environment:
      - AZURE_OPENAI_ENDPOINT=${AZURE_OPENAI_ENDPOINT}
      - AZURE_OPENAI_API_KEY=${AZURE_OPENAI_API_KEY}
      - AZURE_OPENAI_DEPLOYMENT_NAME=${AZURE_OPENAI_DEPLOYMENT_NAME}
      - AZURE_OPENAI_API_VERSION=${AZURE_OPENAI_API_VERSION}
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    depends_on:
      - kadaster-service
      - cbs-service
      - rijkswaterstaat-service

  orchestrator:
    build:
      context: ./client
      dockerfile: Dockerfile
    container_name: eai-orchestrator
    ports:
      - "5000:5000"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./ontology:/app/ontology
    depends_on:
      - kadaster-service
      - cbs-service
      - rijkswaterstaat-service
    restart: unless-stopped

  dashboard:
    image: nginx:alpine
    container_name: eai-dashboard
    ports:
      - "8080:80"
    volumes:
      - ./dashboard:/usr/share/nginx/html
    restart: unless-stopped
